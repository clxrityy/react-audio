import{r as i,j as r}from"./index-D4QDkaZQ.js";import{c as L,A as $}from"./cn-C0L4zdn3.js";import"./dialog-C9q3Mh8B.js";function H({audioRef:o,width:D="100%",height:k="25%",fftSize:v=1024,minDecibels:C=-100,maxDecibels:w=-25,colorMap:d=["#111","#ff0000","#ffff00","#ffffff"],smoothingTimeConstant:E=.8,realTime:V=!0,logarithmicScale:z=!0,onFrameUpdate:y,fillStyle:b,loop:j,...h}){const f=i.useRef(null),N=i.useRef(null),S=i.useRef(null),[A,P]=i.useState(!1),[F,R]=i.useState(!1),[q,I]=i.useState(null),M=()=>{var t;if(A){(t=o.current)==null||t.pause(),P(!1);return}if(o.current){if(!N.current){const e=new(window.AudioContext||window.webkitAudioContext),s=e.createAnalyser();N.current=e,S.current=s,s.fftSize=v,s.minDecibels=C,s.maxDecibels=w,s.smoothingTimeConstant=E,e.createMediaElementSource(o.current).connect(s),s.connect(e.destination)}N.current.state==="suspended"&&N.current.resume(),o.current.paused&&o.current.play(),j&&(o.current.loop=!0),P(e=>!e)}};return i.useEffect(()=>{if(!f.current||!o.current)return;const t=f.current,e=t.getContext("2d");if(!e)return;t.width=800,t.height=400;const s=(l,p,c)=>`#${l.slice(1).match(/.{2}/g).map((x,g)=>{const a=parseInt(x,16),B=parseInt(p.slice(1).match(/.{2}/g)[g],16);return Math.round(a+c*(B-a)).toString(16).padStart(2,"0")}).join("")}`,U=l=>{const c=l/255*(d.length-1),u=Math.floor(c),x=c-u,g=d[u],a=d[u+1]||g;return s(g,a,x)},T=()=>{if(!t||!e||!S.current)return;const l=S.current.frequencyBinCount,p=new Uint8Array(l);S.current.getByteFrequencyData(p),e.fillStyle=b||"rgba(0, 0, 0, 0.5)",e.fillRect(0,0,t.width,t.height);for(let c=0;c<l;c++){const u=p[c],x=u/255*t.height,g=t.height-x,a=t.width/l;e.fillStyle=U(u),e.fillRect(c*a,g,a,x)}I(requestAnimationFrame(T)),y==null||y(p)};return A&&T(),()=>{cancelAnimationFrame(q)}},[A,d,b]),r.jsxDEV("canvas",{onClick:()=>{M(),R(!0)},className:`border border-zinc-800/65 dark:border-zinc-500/65 rounded-md cursor-pointer backdrop:invert-50 ${!F&&"bg-zinc-700/50 animate-pulse hover:border-2 transition-all hover:bg-zinc-700/75 hover:animate-none"}`,ref:f,style:{width:D,height:k},...h},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/Display.tsx",lineNumber:164,columnNumber:9},this)}function n({track:o,fftSize:D,width:k,height:v,minDecibels:C,maxDecibels:w,colorMap:d,smoothingTimeConstant:E,realTime:V,logarithmicScale:z,onFrameUpdate:y,loop:b,fillStyle:j,...h}){const f=i.useRef(new Audio(o.src));return r.jsxDEV("div",{...h,className:L("",h.className),children:[r.jsxDEV("audio",{ref:f,children:r.jsxDEV($,{src:o.src},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:44,columnNumber:17},this)},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:43,columnNumber:13},this),r.jsxDEV(H,{audioRef:f,fftSize:D,width:k,height:v,minDecibels:C,maxDecibels:w,colorMap:d,smoothingTimeConstant:E,realTime:V,logarithmicScale:z,onFrameUpdate:y,loop:b,fillStyle:j},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:46,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:42,columnNumber:9},this)}const ee={title:"Spectrogram",component:n},m={track:{src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"}},te=()=>r.jsxDEV(n,{...m},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:18,columnNumber:30},void 0),W={...m,width:400,height:200},re=()=>r.jsxDEV(n,{...W},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:26,columnNumber:33},void 0),_={...m,colorMap:["#333","#255","#888","#ddd"]},oe=()=>r.jsxDEV(n,{..._},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:33,columnNumber:37},void 0),G={...m,fillStyle:"#ddd"},se=()=>r.jsxDEV(n,{...G},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:40,columnNumber:38},void 0),J={...m,loop:!0},ce=()=>r.jsxDEV(n,{...J},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:47,columnNumber:27},void 0),K={...m,smoothingTimeConstant:.9},ie=()=>r.jsxDEV(n,{...K},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:55,columnNumber:5},void 0),O={...m,fftSize:2048},ne=()=>r.jsxDEV(n,{...O},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:63,columnNumber:36},void 0);typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{oe as CustomColorMap,ne as CustomFFTSize,se as CustomFillStyle,re as CustomSize,ie as CustomSmoothingTimeConstant,te as Default,ce as Loop,ee as default};
