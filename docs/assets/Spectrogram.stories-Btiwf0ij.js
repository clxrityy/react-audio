import{r as i,j as r}from"./index-QQteKcub.js";import{c as L,A as $}from"./cn-B9hpSFVo.js";import"./dialog-Bx1rcXiD.js";function W({audioRef:o,width:D="100%",height:k="25%",fftSize:v=1024,minDecibels:C=-100,maxDecibels:w=-25,colorMap:f=["#111","#ff0000","#ffff00","#ffffff"],smoothingTimeConstant:E=.8,realTime:V=!0,logarithmicScale:z=!0,onFrameUpdate:y,fillStyle:b,loop:j,...N}){const d=i.useRef(null),h=i.useRef(null),S=i.useRef(null),[A,P]=i.useState(!1),[F,R]=i.useState(!1),[q,I]=i.useState(null),M=()=>{var t;if(A){(t=o.current)==null||t.pause(),P(!1);return}if(o.current){if(!h.current){const e=new(window.AudioContext||window.webkitAudioContext),s=e.createAnalyser();h.current=e,S.current=s,s.fftSize=v,s.minDecibels=C,s.maxDecibels=w,s.smoothingTimeConstant=E,e.createMediaElementSource(o.current).connect(s),s.connect(e.destination)}h.current.state==="suspended"&&h.current.resume(),o.current.paused&&o.current.play(),j&&(o.current.loop=!0),P(e=>!e)}};return i.useEffect(()=>{if(!d.current||!o.current)return;const t=d.current,e=t.getContext("2d");if(!e)return;t.width=800,t.height=400;const s=(l,p,c)=>`#${l.slice(1).match(/.{2}/g).map((x,g)=>{const u=parseInt(x,16),B=parseInt(p.slice(1).match(/.{2}/g)[g],16);return Math.round(u+c*(B-u)).toString(16).padStart(2,"0")}).join("")}`,U=l=>{const c=l/255*(f.length-1),a=Math.floor(c),x=c-a,g=f[a],u=f[a+1]||g;return s(g,u,x)},T=()=>{if(!t||!e||!S.current)return;const l=S.current.frequencyBinCount,p=new Uint8Array(l);S.current.getByteFrequencyData(p),e.fillStyle=b||"rgba(0, 0, 0, 0.5)",e.fillRect(0,0,t.width,t.height);for(let c=0;c<l;c++){const a=p[c],x=a/255*t.height,g=t.height-x,u=t.width/l;e.fillStyle=U(a),e.fillRect(c*u,g,u,x)}I(requestAnimationFrame(T)),y==null||y(p)};return A&&T(),()=>{cancelAnimationFrame(q)}},[A,f,b]),r.jsxDEV("canvas",{onClick:()=>{M(),R(!0)},className:`border border-zinc-800/65 dark:border-zinc-500/65 rounded-md cursor-pointer backdrop:invert-50 ${!F&&"bg-zinc-700/50 animate-pulse hover:border-2 transition-all hover:bg-zinc-700/75 hover:animate-none"}`,ref:d,style:{width:D,height:k},...N},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/Display.tsx",lineNumber:150,columnNumber:10},this)}function n({track:o,fftSize:D,width:k,height:v,minDecibels:C,maxDecibels:w,colorMap:f,smoothingTimeConstant:E,realTime:V,logarithmicScale:z,onFrameUpdate:y,loop:b,fillStyle:j,...N}){const d=i.useRef(new Audio(o.src));return r.jsxDEV("div",{...N,className:L("",N.className),children:[r.jsxDEV("audio",{ref:d,children:r.jsxDEV($,{src:o.src},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:45,columnNumber:17},this)},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:44,columnNumber:13},this),r.jsxDEV(W,{audioRef:d,fftSize:D,width:k,height:v,minDecibels:C,maxDecibels:w,colorMap:f,smoothingTimeConstant:E,realTime:V,logarithmicScale:z,onFrameUpdate:y,loop:b,fillStyle:j},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:47,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/lib/Spectrogram/index.tsx",lineNumber:43,columnNumber:9},this)}const ee={title:"Spectrogram",component:n},m={track:{src:"/dreamy-guitar-loop.mp3"}},te=()=>r.jsxDEV(n,{...m},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:18,columnNumber:30},void 0),_={...m,width:400,height:200},re=()=>r.jsxDEV(n,{..._},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:26,columnNumber:33},void 0),G={...m,colorMap:["#333","#255","#888","#ddd"]},oe=()=>r.jsxDEV(n,{...G},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:33,columnNumber:37},void 0),H={...m,fillStyle:"#ddd"},se=()=>r.jsxDEV(n,{...H},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:40,columnNumber:38},void 0),J={...m,loop:!0},ce=()=>r.jsxDEV(n,{...J},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:47,columnNumber:27},void 0),K={...m,smoothingTimeConstant:.9},ie=()=>r.jsxDEV(n,{...K},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:54,columnNumber:50},void 0),O={...m,fftSize:2048},ne=()=>r.jsxDEV(n,{...O},void 0,!1,{fileName:"/Users/clxrity/Desktop/stuff/code/pkg (@clxrity)/react-audio/src/stories/Spectrogram.stories.tsx",lineNumber:61,columnNumber:36},void 0);typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{oe as CustomColorMap,ne as CustomFFTSize,se as CustomFillStyle,re as CustomSize,ie as CustomSmoothingTimeConstant,te as Default,ce as Loop,ee as default};
